<div class="ma_page_content" id="container_blog">
    <div class="ma_pc_inner">
        <div class="page_padding">
			<div class="ma_tabs">
				<ul class="list-unstyled mb-0">
					<li>
						<a href="{{LINK ads}}" data-load="ads"><svg xmlns="http://www.w3.org/2000/svg" width="22.684" height="25.409" viewBox="0 0 22.684 25.409"> <g id="megaphone-advertising-svgrepo-com" transform="translate(-21.124 0.208)"> <g id="Group_9834" data-name="Group 9834" transform="translate(29.549 17.076)"> <g id="Group_9833" data-name="Group 9833"> <path id="Path_215925" data-name="Path 215925" d="M151.184,268.135a.7.7,0,0,0-.7.7v2.1a.7.7,0,1,0,1.391,0v-2.1A.7.7,0,0,0,151.184,268.135Z" transform="translate(-150.488 -268.135)" fill="currentColor" stroke="#fff" stroke-width="0.4"></path> </g> </g> <g id="Group_9836" data-name="Group 9836" transform="translate(21.324 0)"> <g id="Group_9835" data-name="Group 9835"> <path id="Path_215926" data-name="Path 215926" d="M40.492,6.24V.691a.692.692,0,0,0-.984-.63L28.693,5.116H22.02a.7.7,0,0,0-.7.7v8.361a.7.7,0,0,0,.7.7h.626l1.918,9.576a.692.692,0,0,0,.679.556h3.825a.7.7,0,0,0,.7-.7c0-.078-1.885-9.44-1.885-9.44h.811L39.5,19.92c.819.2.984-.4.984-.63V13.741a3.814,3.814,0,0,0,.008-7.5ZM28.216,23.609h-2.4l-1.754-8.744h2.4Zm.074-10.131H22.715V6.5H28.29v6.974ZM39.1,18.2,29.681,13.79V11.6h.284a.7.7,0,1,0,0-1.391h-.284V8.821h1.671a.7.7,0,0,0,0-1.391H29.681V6.178L39.1,1.773Zm1.387-5.875V7.665a2.428,2.428,0,0,1,0,4.656Z" transform="translate(-21.324 0)" fill="currentColor" stroke="#fff" stroke-width="0.4"></path> </g> </g> </g> </svg> {{LANG Advertising}}</a>
					</li>
					<li class="active">
						<a href="{{LINK create-ads}}" data-load="create-ads"><svg xmlns="http://www.w3.org/2000/svg" width="35.447" height="25.567" viewBox="0 0 35.447 25.567"> <g id="marketing-mail-svgrepo-com" transform="translate(-0.01 -39.024)"> <g id="Group_9842" data-name="Group 9842" transform="translate(0.01 39.024)"> <g id="Group_9841" data-name="Group 9841"> <path id="Path_215928" data-name="Path 215928" d="M25.857,143.3V137.02H24.38v1.3c-5.489,5.343-10.843,5.12-12.554,4.876v-.545H5.179a5.166,5.166,0,0,0-.787,10.272l2.284,7.611a2.9,2.9,0,0,0,2.77,2.058,2.929,2.929,0,0,0,.848-.127,2.751,2.751,0,0,0,1.81-1.677,3.2,3.2,0,0,0-.293-2.774,8.274,8.274,0,0,1-1.553-5.023h1.567v-.211c1.685-.292,7.05-.676,12.554,4.679v1.295h1.477v-6.283a4.639,4.639,0,0,0,0-9.162ZM10.55,158.777a1.709,1.709,0,0,1,.174,1.48,1.282,1.282,0,0,1-.86.79A1.421,1.421,0,0,1,8.09,160.1l-2.136-7.117H8.781A9.981,9.981,0,0,0,10.55,158.777Zm-.2-7.269H5.179a3.692,3.692,0,0,1,0-7.385h5.169ZM24.38,155.45c-5.358-4.6-10.491-4.471-12.554-4.169v-6.6a12.354,12.354,0,0,0,1.493.088,16.88,16.88,0,0,0,11.061-4.452Zm1.477-4.493v-6.145a3.158,3.158,0,0,1,0,6.145Z" transform="translate(-0.01 -137.02)" fill="currentColor"></path> </g> </g> <g id="Group_9844" data-name="Group 9844" transform="translate(31.765 49.082)"> <g id="Group_9843" data-name="Group 9843"> <rect id="Rectangle_3540" data-name="Rectangle 3540" width="3.692" height="1.477" fill="currentColor"></rect> </g> </g> <g id="Group_9846" data-name="Group 9846" transform="translate(29.732 43.029)"> <g id="Group_9845" data-name="Group 9845" transform="translate(0 0)"> <rect id="Rectangle_3541" data-name="Rectangle 3541" width="3.692" height="1.477" transform="matrix(0.707, -0.707, 0.707, 0.707, 0, 2.611)" fill="currentColor"></rect> </g> </g> <g id="Group_9848" data-name="Group 9848" transform="translate(29.73 52.952)"> <g id="Group_9847" data-name="Group 9847" transform="translate(0 0)"> <rect id="Rectangle_3542" data-name="Rectangle 3542" width="1.477" height="3.692" transform="translate(0 1.044) rotate(-45)" fill="currentColor"></rect> </g> </g> </g> </svg> {{LANG Create ad}}</a>
					</li>
				</ul>
			</div>
			
			<div class="row">
				<div class="col-lg-8 offset-lg-2">
					<div class="content upload_music no-flex ds_create_edit_ads_cont p-5">
						<?php if ($music->user->wallet == '0.00' || $music->user->wallet == '0') { ?>
							<div class="alert alert-warning">{{LANG Your current wallet balance is: 0, please top up your wallet to continue.}} <a href="{{LINK ads}}" data-load="ads">{{LANG Top Up}}</a></div>
						<?php } ?>
						<form class="user-ads-settings-form ds_create_edit_prods" method="POST">
							<div class="user-ads-settings-alert"></div>
							<div class="alert alert-success ads-settings-alert hidden"></div>
							<div class="progress hidden">
								<div class="upload-progress-bar bar progress-bar progress-bar-striped active"></div>
								<div class="percent">0%</div>
							</div>
							
							<h3 class="mat_form_title mb-4">{{LANG camp_details}}</h3>
							<div class="row">
								<div class="col-md-6">
									<div class="form-group mat_input float">
										<input type="text" id="name" name="name" class="form-control" placeholder=" " <?php if ($music->user->wallet == '0.00' || $music->user->wallet == '0') { echo 'disabled'; }?>>
										<label class="col-md-12" for="name">{{LANG name}}</label>
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group mat_input float">
										<input type="text" id="title" name="title" class="form-control" placeholder=" " <?php if ($music->user->wallet == '0.00' || $music->user->wallet == '0') { echo 'disabled'; }?>>
										<label class="col-md-12" for="title">{{LANG title}}</label>
									</div>
								</div>
							</div>
							
							<div class="form-group mat_input float">
								<input type="text" id="url" name="url" class="form-control" placeholder=" " <?php if ($music->user->wallet == '0.00' || $music->user->wallet == '0') { echo 'disabled'; }?>>
								<label class="col-md-12" for="url">{{LANG URL}}</label>
							</div>
					
							<div class="row">
								<div class="col-md-6">
									<div class="form-group mat_input float">
										<select class="form-control selectpicker show-menu-arrow show-tick" multiple name="audience-list[]" data-live-search="true" title="{{LANG Target Audience}}" data-actions-box="true" name="audience-list[]" <?php if ($music->user->wallet == '0.00' || $music->user->wallet == '0') { echo 'disabled'; }?>>
											<?php foreach ($countries_name as $country_id => $country_name): ?>
												<option value="<?php echo($country_id); ?>"><?php echo($country_name); ?></option>
											<?php endforeach; ?>
										</select>
										<label class="col-md-12">{{LANG Target Audience}}</label>
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group mat_input float">
										<select name="placement" id="ad-placement" class="form-control" <?php if ($music->user->wallet == '0.00' || $music->user->wallet == '0') { echo 'disabled'; }?>>
											<option value="1">{{LANG Show only in track page}}</option>
											<option value="2">{{LANG Show on all pages}}</option>
										</select>
										<label class="col-md-12" for="ad-placement">{{LANG Placement}}</label>  
									</div>
								</div>
							</div>
					
							<div class="row">
								<div class="col-md-6">
									<div class="form-group mat_input float">
										<select name="cost" id="cost" class="form-control">
											<option value="1">{{LANG Pay Per Click}} ({{CURRENCY}} {{CONFIG ad_c_price}})</option>
											<option value="2">{{LANG Pay Per Impression}} ({{CURRENCY}} {{CONFIG ad_v_price}})</option>
										</select>
										<label class="col-md-12" for="cost">{{LANG Pricing}}</label>
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group mat_input float">
										<input type="number" id="day_limit" name="day_limit" class="form-control" placeholder=" " oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');">
										<label class="col-md-12" for="day_limit">{{LANG Spending limit per day}}</label>  
									</div>
								</div>
							</div>
							
							<?php if ($music->config->audio_ads == 'on' && $music->config->can_use_audio_ads) { ?>
								<div class="form-group mat_input float">
									<select name="type" id="type" class="form-control" onchange="ShowAudio(this)">
										<option value="banner">{{LANG Banners Ads}}</option>
										<option value="audio">{{LANG Audio Ads}}</option>
									</select>
									<label class="col-md-12" for="type"> {{LANG Type}}</label>
								</div>
							<?php } ?>
							
							<h3 class="mat_form_title mt-5 mb-4">{{LANG camp_desc}}</h3>
							<div class="form-group mat_input float">
								<textarea name="desc" id="desc" rows="4" class="form-control" placeholder=" " <?php if ($music->user->wallet == '0.00' || $music->user->wallet == '0') { echo 'disabled'; }?>></textarea>
								<label class="col-md-12" for="desc">{{LANG description}}</label>
							</div>
							
							<h3 class="mat_form_title mt-5 mb-4">{{LANG camp_media}}</h3>
							<div class="form-group mat_input">
								<div class="ds_media_file mt-0 mat_file_upload image_class">
									<span class="btn btn-file image_file" onclick="$('#ad-media').trigger('click'); return false;">
										<span id="ad-media-holder"><svg xmlns="http://www.w3.org/2000/svg" width="62.982" height="57.205" viewBox="0 0 62.982 57.205"> <path id="Path_6622" data-name="Path 6622" d="M3782.481,7254.287l12.127,12.129-4.032,4.033-5.234-5.207V7281.2h-5.721v-15.988l-5.234,5.234-4.032-4.033Zm0-30.289a19.963,19.963,0,0,1,19.878,17.705,15.79,15.79,0,0,1,11.555,16.561,15.735,15.735,0,0,1-14.271,14.3V7266.9a17.168,17.168,0,0,0-34.322-.658v6.32a15.742,15.742,0,0,1-2.717-30.861A19.963,19.963,0,0,1,3782.481,7224Z" transform="translate(-3750.99 -7223.998)" fill="#d8d8d8"></path> </svg> {{LANG Select Media}}</span>
									</span>
									<input type="file" class="media" id="ad-media" name="media" accept="image/* video/*" <?php if ($music->user->wallet == '0.00' || $music->user->wallet == '0') { echo 'disabled'; }?>>
								</div>
							</div>
							
							<?php if ($music->config->audio_ads == 'on' && $music->config->can_use_audio_ads) { ?>
								<div class="form-group mat_input">
									<div class="ds_media_file mt-0 mat_file_upload audio_class" style="display: none;">
										<span class="btn btn-file image_file" onclick="$('#audio').trigger('click'); return false;">
											<span id="ad-media-holder"><svg xmlns="http://www.w3.org/2000/svg" width="62.982" height="57.205" viewBox="0 0 62.982 57.205"> <path id="Path_6622" data-name="Path 6622" d="M3782.481,7254.287l12.127,12.129-4.032,4.033-5.234-5.207V7281.2h-5.721v-15.988l-5.234,5.234-4.032-4.033Zm0-30.289a19.963,19.963,0,0,1,19.878,17.705,15.79,15.79,0,0,1,11.555,16.561,15.735,15.735,0,0,1-14.271,14.3V7266.9a17.168,17.168,0,0,0-34.322-.658v6.32a15.742,15.742,0,0,1-2.717-30.861A19.963,19.963,0,0,1,3782.481,7224Z" transform="translate(-3750.99 -7223.998)" fill="#d8d8d8"></path> </svg> {{LANG Select Audio}}</span>
										</span>
										<input type="file" class="media" id="audio" name="audio" accept="audio/wav,audio/mpeg,audio/ogg,audio/mp3" <?php if ($music->user->wallet == '0.00' || $music->user->wallet == '0') { echo 'disabled'; }?>>
										<input type="text" readonly id="audio_name" style="display: none;">
									</div>
								</div>
							<?php } ?>
						  
							<div class="last-sett-btn modal-footer mat_sett_btn">
								<button type="submit" class="btn btn-primary btn-mat" id="submit-btn" <?php if ($music->user->wallet == '0.00' || $music->user->wallet == '0') { echo 'disabled'; }?>>{{LANG Publish}}</button>
							</div>
						</form>
					</div>
				</div>
			</div>
        </div>
    </div>
</div>

<script>
function ShowAudio(self) {
  if ($(self).val() == 'audio') {
    $('.audio_class').slideDown();
    $('.image_class').slideUp();
    $('#cost').html('<option value="2">{{LANG Pay Per Impression}} ({{CURRENCY}} {{CONFIG ad_v_price}})</option>');
    $('#ad-placement').html('<option value="1">{{LANG Show only in track page}}</option>');
    $('#ad-placement').attr('disabled', 'true');
  }
  else{
    $('.audio_class').slideUp();
    $('.image_class').slideDown();
    $('#cost').html('<option value="1">{{LANG Pay Per Click}} ({{CURRENCY}} {{CONFIG ad_c_price}})</option><option value="2">{{LANG Pay Per Impression}} ({{CURRENCY}} {{CONFIG ad_v_price}})</option>');
    $('#ad-placement').html('<option value="1">{{LANG Show only in track page}}</option><option value="2">{{LANG Show on all pages}}</option>');
    $('#ad-placement').removeAttr('disabled')
  }
}
$(document).ready(function() {
	$("#ad-media").on('change', function() {
	//Get count of selected files
	$("#ad-media-holder").html("<img src='" + window.URL.createObjectURL(this.files[0]) + "' alt='Picture'>");
	});
  $("#audio").on('change', function() {
        $('#audio_name').slideDown();
        $('#audio_name').val(this.files[0].name);
  });
});

    var _Delay = (function(){
        var timer = 0;
        return function(callback, ms){
            clearTimeout (timer);
            timer = setTimeout(callback, ms);
        };
    })();

    function scrollToTop() {
        verticalOffset = typeof (verticalOffset) != 'undefined' ? verticalOffset : 0;
        element = $('html');
        offset = element.offset();
        offsetTop = offset.top;
        $('html, body').animate({
            scrollTop: offsetTop
        }, 300, 'linear');
    }
    function HasExtension(id, exts) {
        var fileName = $(id).val();
        return (new RegExp('(' + exts.join('|').replace(/\./g, '\\.') + ')$')).test(fileName);
    }
  var bar         = $('.bar');
  var percent     = $('.percent');

	jQuery(document).ready(function($) {
	  $('.selectpicker').selectpicker({});

    $("#ad-placement").change(function(event) {
      if ($(this).val() == 2) {
        $("#cost").find("option[value='2']").removeAttr('selected').attr('disabled', 'disabled');
      }
      
      else{
        $("#cost").find("option").removeAttr('disabled');
      }
    });

    $('.user-ads-settings-form').submit(function(event) {
      if ($("#ad-placement").val() == 2 && $("#ad-media").val() != ''){  
        var mediafile = HasExtension('#ad-media', ['.jpg', '.gif', '.png', '.jpeg', '.webp']);
        if (!mediafile){
          scrollToTop();
          $('#ad-media').val('');
          $(".user-ads-settings-alert").html("<div class='alert alert-danger'><i class='fa fa-info-circle'></i> {{LANG Media file is invalid. Please select a valid image}}</div>");
          return false;
        }
      }
    });

    $('.user-ads-settings-form').ajaxForm({
      url: '{{CONFIG ajax_url}}/ads/create?hash_id=' + getHashID(),
      dataType:"json",
      beforeSend: function() {

        var mediafile = $("#ad-media").prop('files');
        if( $("#ad-media").val() ) {
            if (mediafile[0].size > "{{CONFIG max_upload}}") {
                swal({
                    title: '{{LANG Error!}}',
                    text: "{{LANG File is too big, Max upload size is}} <?php echo size_format($music->config->max_upload); ?>",
                    type: 'error',
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'OK',
                    buttonsStyling: true,
                    confirmButtonClass: 'btn btn-success',
                }).then(function () {
                        swal.close();
                        $("#ad-media").val('');
                    },
                    function () {
                        swal.close();
                        $("#ad-media").val('');
                    });
                return false;
            }
        }
        if ($("#ad-media").val()) {
          $(".user-ads-settings-alert").html($('.progress').clone(true).addClass('progress-clone').removeClass('hidden'));
          bar     = $('.progress-clone').find('.bar');
          percent = $('.progress-clone').find('.percent');
        }

        $('#submit-btn').attr('disabled', true).find('span').text("{{LANG Please wait..}}");
        
      },
      uploadProgress: function(event, position, total, percentComplete) {
          if(percentComplete > 50) {
            percent.addClass('white');
          }
          var percentVal = percentComplete + '%';
          bar.width(percentVal);
          percent.html(percentVal);

          if (percentComplete == 100) {
            $(".user-ads-settings-alert").empty();
          }
      },
      success: function(data) {
        scrollToTop();
        if (data.status == 200){
          $(".user-ads-settings-alert").html('<div class="alert alert-success"><i class="fa fa-check"></i> '+
            data.message
            +'</div>');
            _Delay(function(){
            window.location.href = '{{LINK ads}}';
          },2000);
          
        }
        else {
          $('#submit-btn').removeAttr('disabled').find('span').text('{{LANG Publish}}');
          $(".user-ads-settings-alert").html('<div class="alert alert-danger"><i class="fa fa-info-circle"></i> '+
            data.message
            +'</div>');
        }
      }
    });
	});
</script>


